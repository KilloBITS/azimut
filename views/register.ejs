<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<meta name="Description" content="Радиоклуб АЗИМУТ">
	<title>Регистрация</title>
	<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=yes">
	<link rel="shortcut icon" href="../favicon.ico" type="image/x-icon">
	<link rel="stylesheet" type="text/css" href="/style/loader.css">
	<link rel="stylesheet" type="text/css" href="/style/global.css">
	<link rel="stylesheet" type="text/css" href="/style/global.min.css">
	<link rel="stylesheet" type="text/css" href="/style/register/style.css">
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css">
	<script type="text/javascript" src="./data/header.json"></script>
	<script type="text/javascript" src="/script/jquery-3.2.1.js"></script>
	<script type="text/javascript" src="/script/jquery-3.2.1.min.js"></script>
	<script type="text/javascript" src="/script/jquery-ui.js"></script>
	<script type="text/javascript" src="/script/jquery.cookie.js"></script>
	<script type="text/javascript" src="/script/index.js"></script>
	<script type="text/javascript" src="/script/register/register.js"></script>
	<% if(sessionUser === undefined){ %>
	<script type="text/javascript" src="/script/loginMethod.js"></script>	
	<% } %>	
</head>
<body>	
	<%- include ./includes/mini_panel.ejs %>
	<div class="wrapper">
		<div id="loader-wrapper">
			<div id="loader">
				<div class="pulse"></div>
			</div>
			<div class="loader-section section-left"></div>
			<div class="loader-section section-right"></div>
		</div>
	</div>
	<header>	
		<canvas id="canvas"></canvas>
		<canvas id="spectr"></canvas>
		<img src="../../../img/logo1.png" id="logotype">		
		<h1>Радиоклуб <b>Азимут</b></h1>		
		<div class="toScroll">
			<div class="scroll-arrow"></div>
			<div class="scroll-arrow"></div>
			<div class="scroll-arrow"></div>
		</div>		
		<div id="head_banner"><%= locator %></div>
		<nav> 
			<h1><b>РЕГИСТРАЦИЯ</b></h1>	
			<div class="mobileWrapper">
				<a class="menu-2" data-menu="2"></a>
			</div>
			<a href="/"><%= page.top_menu[0] %></a>
			<a href="/about"><%= page.top_menu[1] %></a> 
			<a href="/news?page=1"><%= page.top_menu[2] %></a> 
			<a href="/VHF?page=1" class="menu_to_left"><%= page.top_menu[3] %></a> 
			<a href="/HF?page=1" class="menu_to_right"><%= page.top_menu[4] %></a> 
			<a href="#"><%= page.top_menu[5] %></a> 
			<a href="/market"><%= page.top_menu[6] %></a> 
			<a href="/contacts"><%= page.top_menu[7] %></a> 
		</nav>
	</header>
	<main class="wrapper">
		<div class="nav_menu left">
			<div class="nav_wrapper">
				<div class="wrapper_title"><%= page.navigation %></div>
				<div class="pre_line"></div>
				<%- include ./includes/left_nav.ejs %>				
			</div>
			<div class="nav_wrapper">
				<div class="wrapper_title"><%= page.information %></div>
				<div class="pre_line"></div>				
				<%- include ./includes/information.ejs %>
			</div>
		</div>
		<div class="nav_menu right">
			<%- include ./includes/user_block.ejs %>	

			<div class="nav_wrapper">
				<div class="wrapper_title">APRS</div>
				<div class="pre_line"></div>
				<a class="none_text" href="https://www.aprsdirect.com/center/49.82786,24.03119/zoom/11/time/60" target="_blank">
					<img src="../../../img/aprs.png" width="228">
					<div class="a_btn"><%= page.openMap %></div>
				</a>
			</div>
		</div>
		<div class="navigator">
			<a href="/" id="nav_home" class="navigator_btn">Главная</a>
			<a href="/register" id="nav_register" class="navigator_btn selected_nav">Регистрация</a>
		</div>	
		<div class="u-pad-s u-pad-vertical-xl client-view" id="registerBlockData">
			<div id="regisretSuccessFull">
				<img src="data:image/svg+xml;utf8;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iaXNvLTg4NTktMSI/Pgo8IS0tIEdlbmVyYXRvcjogQWRvYmUgSWxsdXN0cmF0b3IgMTkuMC4wLCBTVkcgRXhwb3J0IFBsdWctSW4gLiBTVkcgVmVyc2lvbjogNi4wMCBCdWlsZCAwKSAgLS0+CjxzdmcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgdmVyc2lvbj0iMS4xIiBpZD0iTGF5ZXJfMSIgeD0iMHB4IiB5PSIwcHgiIHZpZXdCb3g9IjAgMCA1MDQuMTIgNTA0LjEyIiBzdHlsZT0iZW5hYmxlLWJhY2tncm91bmQ6bmV3IDAgMCA1MDQuMTIgNTA0LjEyOyIgeG1sOnNwYWNlPSJwcmVzZXJ2ZSIgd2lkdGg9IjUxMnB4IiBoZWlnaHQ9IjUxMnB4Ij4KPGNpcmNsZSBzdHlsZT0iZmlsbDojM0RCMzlFOyIgY3g9IjI1Mi4wNiIgY3k9IjI1Mi4wNiIgcj0iMjUyLjA2Ii8+CjxwYXRoIHN0eWxlPSJmaWxsOiMzN0ExOEU7IiBkPSJNNDYzLjE2MywxMTQuNjA5TDI0MC4yNDYsMzQ1LjQwM2wwLjM5NCwyNC44MTJoMTAuMjRsMjQxLjQyOC0xOTQuNTYgIEM0ODUuMjE4LDE1My45OTQsNDc1LjM3MiwxMzMuMTIsNDYzLjE2MywxMTQuNjA5eiIvPgo8cGF0aCBzdHlsZT0iZmlsbDojRjJGMUVGOyIgZD0iTTQ5OS4zOTcsMTAzLjU4MmwtNDQuNTA1LTQ0LjExMWMtNS45MDgtNS45MDgtMTUuNzU0LTUuOTA4LTIyLjA1NSwwTDI0Mi42MDksMjU2bC04Mi4zMTQtODEuMTMyICBjLTUuOTA4LTUuOTA4LTE1Ljc1NC01LjkwOC0yMi4wNTUsMGwtMzkuMzg1LDM4Ljk5MWMtNS45MDgsNS45MDgtNS45MDgsMTUuNzU0LDAsMjEuNjYyTDIzMC40LDM2NS44ODMgIGMzLjU0NSwzLjU0NSw4LjI3MSw0LjcyNiwxMi45OTcsNC4zMzJjNC43MjYsMC4zOTQsOS40NTItMC43ODgsMTIuOTk3LTQuMzMybDI0My4wMDMtMjQwLjI0NiAgQzUwNS4zMDUsMTE5LjMzNSw1MDUuMzA1LDEwOS40ODksNDk5LjM5NywxMDMuNTgyeiIvPgo8cGF0aCBzdHlsZT0iZmlsbDojRTZFNUUzOyIgZD0iTTI1Ni4zOTQsMzY1Ljg4M2wyNDMuMDAzLTI0MC4yNDZjNS45MDgtNS45MDgsNS45MDgtMTUuNzU0LDAtMjEuNjYybC03LjA4OS02LjY5NUwyNDMuMDAzLDM0Mi4yNTIgIEwxMDUuMTU3LDIwNy45NTFsLTUuOTA4LDUuOTA4Yy01LjkwOCw1LjkwOC01LjkwOCwxNS43NTQsMCwyMS42NjJsMTMxLjU0NSwxMzAuMzYzYzMuNTQ1LDMuNTQ1LDguMjcxLDQuNzI2LDEyLjk5Nyw0LjMzMiAgQzI0OC4xMjMsMzcwLjYwOSwyNTIuODQ5LDM2OS40MjgsMjU2LjM5NCwzNjUuODgzeiIvPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8L3N2Zz4K">
				<h2>Регистрация прошла успешно</h2>
				<h3>Лист с подтверждением отправлен вам на електронную почту</h3>
			</div>
			<h1 class="u-font-center">Регистрация аккаунта</h1>
			<form class="u-mar-bottom-l">
				<div class="o-grid">
					<div class="o-grid__col o-grid__col--1-of-2">
						<label class="c-label">
							Имя<small>*</small>
							<input class="c-input" type="text" class="checkYou" id="checkText">
						</label>
					</div>
					<div class="o-grid__col o-grid__col--1-of-2">
						<label class="c-label">
							Фамилия<small>*</small>
							<input class="c-input" type="text" class="checkYou" id="checkText2"/>
						</label>
					</div>
				</div>
				<label class="c-label">
					Ваш позывной<small>*</small>
					<input class="c-input" type="text" id="checkPoziv">
				</label>
				<label class="c-label">
					Email<small>*</small>
					<input class="c-input" type="email" id="checkEmail">
				</label>
				<div class="o-grid">
					<div class="o-grid__col o-grid__col--1-of-2">
						<label class="c-label">
							Пароль<small>*</small>
							<input class="c-input" type="password" class="checkYou" id="checkPass">
						</label>
						<!-- Password Strength: begins -->
						<div id="password-strength">  
							<!-- Strength Boxes: Box1 -->
							<div class="box box1">
								<div class="bar-text"></div>
								<div class="bar"></div>
							</div>
							<!-- Strength Boxes: Box2 -->
							<div class="box box2">
								<div class="bar"></div>
							</div>
							<!-- Strength Boxes: Box3 -->
							<div class="box box3">
								<div class="bar"></div>
							</div>
							<!-- Strength Boxes: Box4 -->
							<div class="box box4">
								<div class="bar"></div>
							</div>
						</div>
					</div>
					<div class="o-grid__col o-grid__col--1-of-2">
						<label class="c-label">
							Повторите пароль<small>*</small>
							<input class="c-input" type="password" class="checkYou" id="checkPass2"/>
						</label>
						<div id="password-strength2">  
							
							<!-- Strength Boxes: Box1 -->
							<div class="box box1">
								<div class="bar-text"></div>
								<div class="bar"></div>
							</div>							
							<!-- Strength Boxes: Box2 -->
							<div class="box box2">
								<div class="bar"></div>
							</div>
							
							<!-- Strength Boxes: Box3 -->
							<div class="box box3">
								<div class="bar"></div>
							</div>
							
							<!-- Strength Boxes: Box4 -->
							<div class="box box4">
								<div class="bar"></div>
							</div>
							
						</div>
					</div>
				</div>
				<label class="c-label">
					Номер телефона<small>*</small>
					<input class="c-input" type="text" id="checkNumber">
				</label>
				<label class="c-label" style="text-align: center;">
					<small>* - Обозначены поля обязательные к заполнению!</small>
				</label>

				<label class="c-label" style="text-align: center;" id="captchaLabel">
					<img src="../../../img/spinner-preloader.gif" id="captcha" onclick="captchaMethod();">
					<script type="text/javascript">
						captchaMethod = function(){
							$("#captcha").attr('src','/captcha'+Math.random());
						};
						captchaMethod();
					</script>
					<input type="text" name="captchaText" id="captchaText">
				</label>
				<input type="button" class="c-btn c-btn--primary c-btn--full c-btn--big" id="signUpUser" value="Зарегистрировать" />
			</form>
			<script type="text/javascript">
				var isKyr = function (str) {
					return /[а-я]/i.test(str);
				}
				$('#checkPass').keyup(function(){
					$("#password-strength .bar-text").html(checkStrength($('#checkPass').val(),''))
				})  
				$('#checkPass2').keyup(function(){
					$("#password-strength2 .bar-text").html(checkStrength($('#checkPass2').val(),'2'))
				})  
				var addBlick = function(a){
					$(a).addClass('blink');
					setTimeout(function(){
						$(a).removeClass('blink');
					},1500);					
				}
				$('#signUpUser').click(function(){
					if($("#checkText").val().length >= 3){
						if($("#checkText2").val().length >= 3){
							if($("#checkPoziv").val().length >= 4 || isKyr($("#checkPoziv").val())){
								if($("#checkNumber").val().length >= 10){
									if($('#checkPass').val() === $('#checkPass2').val()){
										var NEW_USER = {};					
										NEW_USER.name =  $('#checkText').val();
										NEW_USER.surname = $('#checkText2').val();
										NEW_USER.email = $('#checkEmail').val();
										NEW_USER.phone_number = $('#checkNumber').val();					
										NEW_USER.password = $('#checkPass').val();
										NEW_USER.poziv = $('#checkPoziv').val();
										NEW_USER.currentCaptcha = $('#captchaText').val();

										$.post('/checkedCaptcha', {currentCaptcha: $('#captchaText').val()}, function(res){
											if(res.code === 500){
												$.post('/signup', NEW_USER, function(res){
													createUsers(res);
													$("#registerBlockData #regisretSuccessFull").fadeIn(300);
												})
											}else{
												createError(res.className, res.message);
												$("#captcha").click();
											}
										});
									}else{
										console.warn('Пароли не совпадают!');
										createError('nError', 'Пароли не совпадают');
										addBlick("#checkPass,#checkPass2");
									}
								}else{
									console.log('Номер указан неверно!');
									createError('nError', 'Номер указан неверно!');
									addBlick("#checkNumber");
								}
							}else{
								console.log('Позывной указан неверно!');
								createError('nError', 'Позывной указан неверно!');
								addBlick("#checkPoziv");
							}
						}else{
							console.log('Некорректное фамилия!');
							createError('nError', 'Некорректное фамилия!');
							addBlick("#checkText2");
						}
					}else{
						console.log('Некорректное имя!');
						createError('nError', 'Некорректное имя!');
						addBlick("#checkText");
					}				
				});
			</script>
			<p class="u-font-center u-font-meta"><a href="/" class="toMain">На главную</a></p>
		</div>		
	</main>
	<div id="stop" class="scrollTop"></div>
	<%- include ./includes/footer.ejs %>
	<div class="notifications"></div> 
</body>
</html>